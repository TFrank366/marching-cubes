#include <emscripten.h>
#include <stdlib.h>

//memory loaded with tables in order vertCoordTable, edgeTable, edgeToVertsTable, triTable

typedef float vert[3];

extern void console_log(float);
extern void console_log_bin(int);

int vertCoordTable[8][3] = {
    {0, 0, 0}, // 0
    {1, 0, 0}, // 1
    {1, 1, 0}, // 2
    {0, 1, 0}, // 3
    {0, 0, 1}, // 4
    {1, 0, 1}, // 5
    {1, 1, 1}, // 6
    {0, 1, 1}, // 7
};

int edgeTable[256][12] = {
    {-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {0,3,8,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {0,1,9,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {1,3,8,9,-1,-1,-1,-1,-1,-1,-1,-1},
    {1,2,10,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {0,1,2,3,8,10,-1,-1,-1,-1,-1,-1},
    {0,2,9,10,-1,-1,-1,-1,-1,-1,-1,-1},
    {2,3,8,9,10,-1,-1,-1,-1,-1,-1,-1},
    {2,3,11,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {0,2,8,11,-1,-1,-1,-1,-1,-1,-1,-1},
    {0,1,2,3,9,11,-1,-1,-1,-1,-1,-1},
    {1,2,8,9,11,-1,-1,-1,-1,-1,-1,-1},
    {1,3,10,11,-1,-1,-1,-1,-1,-1,-1,-1},
    {0,1,8,10,11,-1,-1,-1,-1,-1,-1,-1},
    {0,3,9,10,11,-1,-1,-1,-1,-1,-1,-1},
    {8,9,10,11,-1,-1,-1,-1,-1,-1,-1,-1},
    {4,7,8,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {0,3,4,7,-1,-1,-1,-1,-1,-1,-1,-1},
    {0,1,4,7,8,9,-1,-1,-1,-1,-1,-1},
    {1,3,4,7,9,-1,-1,-1,-1,-1,-1,-1},
    {1,2,4,7,8,10,-1,-1,-1,-1,-1,-1},
    {0,1,2,3,4,7,10,-1,-1,-1,-1,-1},
    {0,2,4,7,8,9,10,-1,-1,-1,-1,-1},
    {2,3,4,7,9,10,-1,-1,-1,-1,-1,-1},
    {2,3,4,7,8,11,-1,-1,-1,-1,-1,-1},
    {0,2,4,7,11,-1,-1,-1,-1,-1,-1,-1},
    {0,1,2,3,4,7,8,9,11,-1,-1,-1},
    {1,2,4,7,9,11,-1,-1,-1,-1,-1,-1},
    {1,3,4,7,8,10,11,-1,-1,-1,-1,-1},
    {0,1,4,7,10,11,-1,-1,-1,-1,-1,-1},
    {0,3,4,7,8,9,10,11,-1,-1,-1,-1},
    {4,7,9,10,11,-1,-1,-1,-1,-1,-1,-1},
    {4,5,9,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {0,3,4,5,8,9,-1,-1,-1,-1,-1,-1},
    {0,1,4,5,-1,-1,-1,-1,-1,-1,-1,-1},
    {1,3,4,5,8,-1,-1,-1,-1,-1,-1,-1},
    {1,2,4,5,9,10,-1,-1,-1,-1,-1,-1},
    {0,1,2,3,4,5,8,9,10,-1,-1,-1},
    {0,2,4,5,10,-1,-1,-1,-1,-1,-1,-1},
    {2,3,4,5,8,10,-1,-1,-1,-1,-1,-1},
    {2,3,4,5,9,11,-1,-1,-1,-1,-1,-1},
    {0,2,4,5,8,9,11,-1,-1,-1,-1,-1},
    {0,1,2,3,4,5,11,-1,-1,-1,-1,-1},
    {1,2,4,5,8,11,-1,-1,-1,-1,-1,-1},
    {1,3,4,5,9,10,11,-1,-1,-1,-1,-1},
    {0,1,4,5,8,9,10,11,-1,-1,-1,-1},
    {0,3,4,5,10,11,-1,-1,-1,-1,-1,-1},
    {4,5,8,10,11,-1,-1,-1,-1,-1,-1,-1},
    {5,7,8,9,-1,-1,-1,-1,-1,-1,-1,-1},
    {0,3,5,7,9,-1,-1,-1,-1,-1,-1,-1},
    {0,1,5,7,8,-1,-1,-1,-1,-1,-1,-1},
    {1,3,5,7,-1,-1,-1,-1,-1,-1,-1,-1},
    {1,2,5,7,8,9,10,-1,-1,-1,-1,-1},
    {0,1,2,3,5,7,9,10,-1,-1,-1,-1},
    {0,2,5,7,8,10,-1,-1,-1,-1,-1,-1},
    {2,3,5,7,10,-1,-1,-1,-1,-1,-1,-1},
    {2,3,5,7,8,9,11,-1,-1,-1,-1,-1},
    {0,2,5,7,9,11,-1,-1,-1,-1,-1,-1},
    {0,1,2,3,5,7,8,11,-1,-1,-1,-1},
    {1,2,5,7,11,-1,-1,-1,-1,-1,-1,-1},
    {1,3,5,7,8,9,10,11,-1,-1,-1,-1},
    {0,1,5,7,9,10,11,-1,-1,-1,-1,-1},
    {0,3,5,7,8,10,11,-1,-1,-1,-1,-1},
    {5,7,10,11,-1,-1,-1,-1,-1,-1,-1,-1},
    {5,6,10,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {0,3,5,6,8,10,-1,-1,-1,-1,-1,-1},
    {0,1,5,6,9,10,-1,-1,-1,-1,-1,-1},
    {1,3,5,6,8,9,10,-1,-1,-1,-1,-1},
    {1,2,5,6,-1,-1,-1,-1,-1,-1,-1,-1},
    {0,1,2,3,5,6,8,-1,-1,-1,-1,-1},
    {0,2,5,6,9,-1,-1,-1,-1,-1,-1,-1},
    {2,3,5,6,8,9,-1,-1,-1,-1,-1,-1},
    {2,3,5,6,10,11,-1,-1,-1,-1,-1,-1},
    {0,2,5,6,8,10,11,-1,-1,-1,-1,-1},
    {0,1,2,3,5,6,9,10,11,-1,-1,-1},
    {1,2,5,6,8,9,10,11,-1,-1,-1,-1},
    {1,3,5,6,11,-1,-1,-1,-1,-1,-1,-1},
    {0,1,5,6,8,11,-1,-1,-1,-1,-1,-1},
    {0,3,5,6,9,11,-1,-1,-1,-1,-1,-1},
    {5,6,8,9,11,-1,-1,-1,-1,-1,-1,-1},
    {4,5,6,7,8,10,-1,-1,-1,-1,-1,-1},
    {0,3,4,5,6,7,10,-1,-1,-1,-1,-1},
    {0,1,4,5,6,7,8,9,10,-1,-1,-1},
    {1,3,4,5,6,7,9,10,-1,-1,-1,-1},
    {1,2,4,5,6,7,8,-1,-1,-1,-1,-1},
    {0,1,2,3,4,5,6,7,-1,-1,-1,-1},
    {0,2,4,5,6,7,8,9,-1,-1,-1,-1},
    {2,3,4,5,6,7,9,-1,-1,-1,-1,-1},
    {2,3,4,5,6,7,8,10,11,-1,-1,-1},
    {0,2,4,5,6,7,10,11,-1,-1,-1,-1},
    {0,1,2,3,4,5,6,7,8,9,10,11},
    {1,2,4,5,6,7,9,10,11,-1,-1,-1},
    {1,3,4,5,6,7,8,11,-1,-1,-1,-1},
    {0,1,4,5,6,7,11,-1,-1,-1,-1,-1},
    {0,3,4,5,6,7,8,9,11,-1,-1,-1},
    {4,5,6,7,9,11,-1,-1,-1,-1,-1,-1},
    {4,6,9,10,-1,-1,-1,-1,-1,-1,-1,-1},
    {0,3,4,6,8,9,10,-1,-1,-1,-1,-1},
    {0,1,4,6,10,-1,-1,-1,-1,-1,-1,-1},
    {1,3,4,6,8,10,-1,-1,-1,-1,-1,-1},
    {1,2,4,6,9,-1,-1,-1,-1,-1,-1,-1},
    {0,1,2,3,4,6,8,9,-1,-1,-1,-1},
    {0,2,4,6,-1,-1,-1,-1,-1,-1,-1,-1},
    {2,3,4,6,8,-1,-1,-1,-1,-1,-1,-1},
    {2,3,4,6,9,10,11,-1,-1,-1,-1,-1},
    {0,2,4,6,8,9,10,11,-1,-1,-1,-1},
    {0,1,2,3,4,6,10,11,-1,-1,-1,-1},
    {1,2,4,6,8,10,11,-1,-1,-1,-1,-1},
    {1,3,4,6,9,11,-1,-1,-1,-1,-1,-1},
    {0,1,4,6,8,9,11,-1,-1,-1,-1,-1},
    {0,3,4,6,11,-1,-1,-1,-1,-1,-1,-1},
    {4,6,8,11,-1,-1,-1,-1,-1,-1,-1,-1},
    {6,7,8,9,10,-1,-1,-1,-1,-1,-1,-1},
    {0,3,6,7,9,10,-1,-1,-1,-1,-1,-1},
    {0,1,6,7,8,10,-1,-1,-1,-1,-1,-1},
    {1,3,6,7,10,-1,-1,-1,-1,-1,-1,-1},
    {1,2,6,7,8,9,-1,-1,-1,-1,-1,-1},
    {0,1,2,3,6,7,9,-1,-1,-1,-1,-1},
    {0,2,6,7,8,-1,-1,-1,-1,-1,-1,-1},
    {2,3,6,7,-1,-1,-1,-1,-1,-1,-1,-1},
    {2,3,6,7,8,9,10,11,-1,-1,-1,-1},
    {0,2,6,7,9,10,11,-1,-1,-1,-1,-1},
    {0,1,2,3,6,7,8,10,11,-1,-1,-1},
    {1,2,6,7,10,11,-1,-1,-1,-1,-1,-1},
    {1,3,6,7,8,9,11,-1,-1,-1,-1,-1},
    {0,1,6,7,9,11,-1,-1,-1,-1,-1,-1},
    {0,3,6,7,8,11,-1,-1,-1,-1,-1,-1},
    {6,7,11,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {6,7,11,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {0,3,6,7,8,11,-1,-1,-1,-1,-1,-1},
    {0,1,6,7,9,11,-1,-1,-1,-1,-1,-1},
    {1,3,6,7,8,9,11,-1,-1,-1,-1,-1},
    {1,2,6,7,10,11,-1,-1,-1,-1,-1,-1},
    {0,1,2,3,6,7,8,10,11,-1,-1,-1},
    {0,2,6,7,9,10,11,-1,-1,-1,-1,-1},
    {2,3,6,7,8,9,10,11,-1,-1,-1,-1},
    {2,3,6,7,-1,-1,-1,-1,-1,-1,-1,-1},
    {0,2,6,7,8,-1,-1,-1,-1,-1,-1,-1},
    {0,1,2,3,6,7,9,-1,-1,-1,-1,-1},
    {1,2,6,7,8,9,-1,-1,-1,-1,-1,-1},
    {1,3,6,7,10,-1,-1,-1,-1,-1,-1,-1},
    {0,1,6,7,8,10,-1,-1,-1,-1,-1,-1},
    {0,3,6,7,9,10,-1,-1,-1,-1,-1,-1},
    {6,7,8,9,10,-1,-1,-1,-1,-1,-1,-1},
    {4,6,8,11,-1,-1,-1,-1,-1,-1,-1,-1},
    {0,3,4,6,11,-1,-1,-1,-1,-1,-1,-1},
    {0,1,4,6,8,9,11,-1,-1,-1,-1,-1},
    {1,3,4,6,9,11,-1,-1,-1,-1,-1,-1},
    {1,2,4,6,8,10,11,-1,-1,-1,-1,-1},
    {0,1,2,3,4,6,10,11,-1,-1,-1,-1},
    {0,2,4,6,8,9,10,11,-1,-1,-1,-1},
    {2,3,4,6,9,10,11,-1,-1,-1,-1,-1},
    {2,3,4,6,8,-1,-1,-1,-1,-1,-1,-1},
    {0,2,4,6,-1,-1,-1,-1,-1,-1,-1,-1},
    {0,1,2,3,4,6,8,9,-1,-1,-1,-1},
    {1,2,4,6,9,-1,-1,-1,-1,-1,-1,-1},
    {1,3,4,6,8,10,-1,-1,-1,-1,-1,-1},
    {0,1,4,6,10,-1,-1,-1,-1,-1,-1,-1},
    {0,3,4,6,8,9,10,-1,-1,-1,-1,-1},
    {4,6,9,10,-1,-1,-1,-1,-1,-1,-1,-1},
    {4,5,6,7,9,11,-1,-1,-1,-1,-1,-1},
    {0,3,4,5,6,7,8,9,11,-1,-1,-1},
    {0,1,4,5,6,7,11,-1,-1,-1,-1,-1},
    {1,3,4,5,6,7,8,11,-1,-1,-1,-1},
    {1,2,4,5,6,7,9,10,11,-1,-1,-1},
    {0,1,2,3,4,5,6,7,8,9,10,11},
    {0,2,4,5,6,7,10,11,-1,-1,-1,-1},
    {2,3,4,5,6,7,8,10,11,-1,-1,-1},
    {2,3,4,5,6,7,9,-1,-1,-1,-1,-1},
    {0,2,4,5,6,7,8,9,-1,-1,-1,-1},
    {0,1,2,3,4,5,6,7,-1,-1,-1,-1},
    {1,2,4,5,6,7,8,-1,-1,-1,-1,-1},
    {1,3,4,5,6,7,9,10,-1,-1,-1,-1},
    {0,1,4,5,6,7,8,9,10,-1,-1,-1},
    {0,3,4,5,6,7,10,-1,-1,-1,-1,-1},
    {4,5,6,7,8,10,-1,-1,-1,-1,-1,-1},
    {5,6,8,9,11,-1,-1,-1,-1,-1,-1,-1},
    {0,3,5,6,9,11,-1,-1,-1,-1,-1,-1},
    {0,1,5,6,8,11,-1,-1,-1,-1,-1,-1},
    {1,3,5,6,11,-1,-1,-1,-1,-1,-1,-1},
    {1,2,5,6,8,9,10,11,-1,-1,-1,-1},
    {0,1,2,3,5,6,9,10,11,-1,-1,-1},
    {0,2,5,6,8,10,11,-1,-1,-1,-1,-1},
    {2,3,5,6,10,11,-1,-1,-1,-1,-1,-1},
    {2,3,5,6,8,9,-1,-1,-1,-1,-1,-1},
    {0,2,5,6,9,-1,-1,-1,-1,-1,-1,-1},
    {0,1,2,3,5,6,8,-1,-1,-1,-1,-1},
    {1,2,5,6,-1,-1,-1,-1,-1,-1,-1,-1},
    {1,3,5,6,8,9,10,-1,-1,-1,-1,-1},
    {0,1,5,6,9,10,-1,-1,-1,-1,-1,-1},
    {0,3,5,6,8,10,-1,-1,-1,-1,-1,-1},
    {5,6,10,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {5,7,10,11,-1,-1,-1,-1,-1,-1,-1,-1},
    {0,3,5,7,8,10,11,-1,-1,-1,-1,-1},
    {0,1,5,7,9,10,11,-1,-1,-1,-1,-1},
    {1,3,5,7,8,9,10,11,-1,-1,-1,-1},
    {1,2,5,7,11,-1,-1,-1,-1,-1,-1,-1},
    {0,1,2,3,5,7,8,11,-1,-1,-1,-1},
    {0,2,5,7,9,11,-1,-1,-1,-1,-1,-1},
    {2,3,5,7,8,9,11,-1,-1,-1,-1,-1},
    {2,3,5,7,10,-1,-1,-1,-1,-1,-1,-1},
    {0,2,5,7,8,10,-1,-1,-1,-1,-1,-1},
    {0,1,2,3,5,7,9,10,-1,-1,-1,-1},
    {1,2,5,7,8,9,10,-1,-1,-1,-1,-1},
    {1,3,5,7,-1,-1,-1,-1,-1,-1,-1,-1},
    {0,1,5,7,8,-1,-1,-1,-1,-1,-1,-1},
    {0,3,5,7,9,-1,-1,-1,-1,-1,-1,-1},
    {5,7,8,9,-1,-1,-1,-1,-1,-1,-1,-1},
    {4,5,8,10,11,-1,-1,-1,-1,-1,-1,-1},
    {0,3,4,5,10,11,-1,-1,-1,-1,-1,-1},
    {0,1,4,5,8,9,10,11,-1,-1,-1,-1},
    {1,3,4,5,9,10,11,-1,-1,-1,-1,-1},
    {1,2,4,5,8,11,-1,-1,-1,-1,-1,-1},
    {0,1,2,3,4,5,11,-1,-1,-1,-1,-1},
    {0,2,4,5,8,9,11,-1,-1,-1,-1,-1},
    {2,3,4,5,9,11,-1,-1,-1,-1,-1,-1},
    {2,3,4,5,8,10,-1,-1,-1,-1,-1,-1},
    {0,2,4,5,10,-1,-1,-1,-1,-1,-1,-1},
    {0,1,2,3,4,5,8,9,10,-1,-1,-1},
    {1,2,4,5,9,10,-1,-1,-1,-1,-1,-1},
    {1,3,4,5,8,-1,-1,-1,-1,-1,-1,-1},
    {0,1,4,5,-1,-1,-1,-1,-1,-1,-1,-1},
    {0,3,4,5,8,9,-1,-1,-1,-1,-1,-1},
    {4,5,9,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {4,7,9,10,11,-1,-1,-1,-1,-1,-1,-1},
    {0,3,4,7,8,9,10,11,-1,-1,-1,-1},
    {0,1,4,7,10,11,-1,-1,-1,-1,-1,-1},
    {1,3,4,7,8,10,11,-1,-1,-1,-1,-1},
    {1,2,4,7,9,11,-1,-1,-1,-1,-1,-1},
    {0,1,2,3,4,7,8,9,11,-1,-1,-1},
    {0,2,4,7,11,-1,-1,-1,-1,-1,-1,-1},
    {2,3,4,7,8,11,-1,-1,-1,-1,-1,-1},
    {2,3,4,7,9,10,-1,-1,-1,-1,-1,-1},
    {0,2,4,7,8,9,10,-1,-1,-1,-1,-1},
    {0,1,2,3,4,7,10,-1,-1,-1,-1,-1},
    {1,2,4,7,8,10,-1,-1,-1,-1,-1,-1},
    {1,3,4,7,9,-1,-1,-1,-1,-1,-1,-1},
    {0,1,4,7,8,9,-1,-1,-1,-1,-1,-1},
    {0,3,4,7,-1,-1,-1,-1,-1,-1,-1,-1},
    {4,7,8,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {8,9,10,11,-1,-1,-1,-1,-1,-1,-1,-1},
    {0,3,9,10,11,-1,-1,-1,-1,-1,-1,-1},
    {0,1,8,10,11,-1,-1,-1,-1,-1,-1,-1},
    {1,3,10,11,-1,-1,-1,-1,-1,-1,-1,-1},
    {1,2,8,9,11,-1,-1,-1,-1,-1,-1,-1},
    {0,1,2,3,9,11,-1,-1,-1,-1,-1,-1},
    {0,2,8,11,-1,-1,-1,-1,-1,-1,-1,-1},
    {2,3,11,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {2,3,8,9,10,-1,-1,-1,-1,-1,-1,-1},
    {0,2,9,10,-1,-1,-1,-1,-1,-1,-1,-1},
    {0,1,2,3,8,10,-1,-1,-1,-1,-1,-1},
    {1,2,10,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {1,3,8,9,-1,-1,-1,-1,-1,-1,-1,-1},
    {0,1,9,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {0,3,8,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1}
};

int edgeToVertsTable[12][2] = {
    {0, 1}, // 0
    {1, 2}, // 1
    {2, 3}, // 2
    {0, 3}, // 3
    {4, 5}, // 4
    {5, 6}, // 5
    {6, 7}, // 6
    {4, 7}, // 7
    {0, 4}, // 8
    {1, 5}, // 9
    {2, 6}, // 10
    {3, 7}, // 11
};

int triTable[256][15] = {
    {-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {0,2,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {0,1,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {0,2,1,3,2,0,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {0,1,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {0,4,3,1,2,5,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {2,1,3,0,1,2,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {0,2,1,0,4,2,4,3,2,-1,-1,-1,-1,-1,-1},
    {1,2,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {0,3,1,2,3,0,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {1,4,0,2,3,5,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {0,4,1,0,3,4,3,2,4,-1,-1,-1,-1,-1,-1},
    {1,2,0,3,2,1,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {0,3,1,0,2,3,2,4,3,-1,-1,-1,-1,-1,-1},
    {1,2,0,1,4,2,4,3,2,-1,-1,-1,-1,-1,-1},
    {1,0,2,2,0,3,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {0,1,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {2,1,0,3,1,2,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {0,1,5,4,2,3,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {2,0,4,2,3,0,3,1,0,-1,-1,-1,-1,-1,-1},
    {0,1,5,4,2,3,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {3,4,5,3,0,4,1,2,6,-1,-1,-1,-1,-1,-1},
    {5,1,6,5,0,1,4,2,3,-1,-1,-1,-1,-1,-1},
    {0,5,4,0,4,3,0,3,1,3,4,2,-1,-1,-1},
    {4,2,3,1,5,0,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {4,2,3,4,1,2,1,0,2,-1,-1,-1,-1,-1,-1},
    {7,0,1,6,4,5,2,3,8,-1,-1,-1,-1,-1,-1},
    {2,3,5,4,2,5,4,5,1,4,1,0,-1,-1,-1},
    {1,5,0,1,6,5,3,4,2,-1,-1,-1,-1,-1,-1},
    {1,5,4,1,2,5,1,0,2,3,5,2,-1,-1,-1},
    {2,3,4,5,0,7,5,7,6,7,0,1,-1,-1,-1},
    {0,1,4,0,4,2,2,4,3,-1,-1,-1,-1,-1,-1},
    {2,1,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {5,3,2,0,4,1,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {0,3,2,1,3,0,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {4,3,2,4,1,3,1,0,3,-1,-1,-1,-1,-1,-1},
    {0,1,5,4,3,2,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {3,0,6,1,2,8,4,7,5,-1,-1,-1,-1,-1,-1},
    {3,1,4,3,2,1,2,0,1,-1,-1,-1,-1,-1,-1},
    {0,5,3,1,0,3,1,3,2,1,2,4,-1,-1,-1},
    {4,3,2,0,1,5,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {0,6,1,0,4,6,2,5,3,-1,-1,-1,-1,-1,-1},
    {0,5,4,0,1,5,2,3,6,-1,-1,-1,-1,-1,-1},
    {1,0,3,1,3,4,1,4,5,2,4,3,-1,-1,-1},
    {5,1,6,5,0,1,4,3,2,-1,-1,-1,-1,-1,-1},
    {2,5,3,0,4,1,4,6,1,4,7,6,-1,-1,-1},
    {3,2,0,3,0,5,3,5,4,5,0,1,-1,-1,-1},
    {1,0,2,1,2,3,3,2,4,-1,-1,-1,-1,-1,-1},
    {3,1,2,0,1,3,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {4,1,0,4,2,1,2,3,1,-1,-1,-1,-1,-1,-1},
    {0,3,4,0,1,3,1,2,3,-1,-1,-1,-1,-1,-1},
    {0,2,1,1,2,3,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {5,3,4,5,2,3,6,0,1,-1,-1,-1,-1,-1,-1},
    {7,1,2,6,4,0,4,3,0,4,5,3,-1,-1,-1},
    {4,0,1,4,1,2,4,2,3,5,2,1,-1,-1,-1},
    {0,4,2,0,2,1,1,2,3,-1,-1,-1,-1,-1,-1},
    {3,5,2,3,4,5,1,6,0,-1,-1,-1,-1,-1,-1},
    {4,2,3,4,3,1,4,1,0,1,3,5,-1,-1,-1},
    {2,3,7,0,1,6,1,5,6,1,4,5,-1,-1,-1},
    {4,1,0,4,0,3,3,0,2,-1,-1,-1,-1,-1,-1},
    {5,2,4,4,2,3,6,0,1,6,1,7,-1,-1,-1},
    {2,3,0,2,0,4,3,6,0,1,0,5,6,5,0},
    {6,5,0,6,0,1,5,2,0,4,0,3,2,3,0},
    {3,2,0,1,3,0,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {2,1,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {0,4,1,2,5,3,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {4,0,1,2,5,3,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {0,4,1,0,5,4,2,6,3,-1,-1,-1,-1,-1,-1},
    {0,3,2,1,3,0,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {1,5,4,1,2,5,3,0,6,-1,-1,-1,-1,-1,-1},
    {4,3,2,4,0,3,0,1,3,-1,-1,-1,-1,-1,-1},
    {2,5,4,2,4,0,2,0,3,1,0,4,-1,-1,-1},
    {0,1,5,4,3,2,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {6,0,4,6,1,0,5,3,2,-1,-1,-1,-1,-1,-1},
    {0,1,6,2,3,8,4,7,5,-1,-1,-1,-1,-1,-1},
    {2,6,3,0,5,1,5,7,1,5,4,7,-1,-1,-1},
    {3,1,4,3,2,1,2,0,1,-1,-1,-1,-1,-1,-1},
    {0,4,5,0,5,2,0,2,1,2,5,3,-1,-1,-1},
    {1,5,3,0,1,3,0,3,2,0,2,4,-1,-1,-1},
    {1,0,3,1,3,4,4,3,2,-1,-1,-1,-1,-1,-1},
    {1,5,2,0,3,4,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {2,1,0,2,5,1,4,3,6,-1,-1,-1,-1,-1,-1},
    {1,7,0,3,8,4,6,2,5,-1,-1,-1,-1,-1,-1},
    {7,4,3,0,6,5,0,5,1,5,6,2,-1,-1,-1},
    {4,0,1,4,3,0,2,5,6,-1,-1,-1,-1,-1,-1},
    {1,2,5,5,2,6,3,0,4,3,4,7,-1,-1,-1},
    {6,2,5,7,0,3,0,4,3,0,1,4,-1,-1,-1},
    {5,1,6,5,6,2,1,0,6,3,6,4,0,4,6},
    {1,8,0,5,6,2,7,4,3,-1,-1,-1,-1,-1,-1},
    {3,6,4,2,5,1,2,1,0,1,5,7,-1,-1,-1},
    {0,1,9,4,7,8,2,3,11,5,10,6,-1,-1,-1},
    {6,1,0,6,8,1,6,2,8,5,8,2,3,7,4},
    {6,2,5,1,7,3,1,3,0,3,7,4,-1,-1,-1},
    {3,1,6,3,6,4,1,0,6,5,6,2,0,2,6},
    {0,3,7,0,4,3,0,1,4,8,4,1,6,2,5},
    {2,1,4,2,4,5,0,3,4,3,5,4,-1,-1,-1},
    {3,0,2,1,0,3,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {2,6,3,2,5,6,0,4,1,-1,-1,-1,-1,-1,-1},
    {4,0,1,4,3,0,3,2,0,-1,-1,-1,-1,-1,-1},
    {4,1,0,4,0,3,4,3,2,3,0,5,-1,-1,-1},
    {0,2,4,0,1,2,1,3,2,-1,-1,-1,-1,-1,-1},
    {3,0,6,1,2,7,2,4,7,2,5,4,-1,-1,-1},
    {0,1,2,2,1,3,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {4,1,0,4,0,2,2,0,3,-1,-1,-1,-1,-1,-1},
    {5,2,4,5,3,2,6,0,1,-1,-1,-1,-1,-1,-1},
    {0,4,1,1,4,7,2,5,6,2,6,3,-1,-1,-1},
    {3,7,2,0,1,5,0,5,4,5,1,6,-1,-1,-1},
    {3,2,0,3,0,5,2,4,0,1,0,6,4,6,0},
    {4,3,2,4,1,3,4,0,1,5,3,1,-1,-1,-1},
    {4,6,1,4,1,0,6,3,1,5,1,2,3,2,1},
    {1,4,3,1,3,0,0,3,2,-1,-1,-1,-1,-1,-1},
    {1,0,2,3,1,2,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {1,4,0,1,2,4,2,3,4,-1,-1,-1,-1,-1,-1},
    {0,3,1,0,5,3,0,4,5,2,3,5,-1,-1,-1},
    {5,2,3,1,5,3,1,3,4,1,4,0,-1,-1,-1},
    {4,2,3,4,3,0,0,3,1,-1,-1,-1,-1,-1,-1},
    {0,1,2,0,2,4,0,4,5,4,2,3,-1,-1,-1},
    {2,4,6,2,6,1,4,5,6,0,6,3,5,3,6},
    {3,4,0,3,0,2,2,0,1,-1,-1,-1,-1,-1,-1},
    {3,1,0,2,3,0,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {0,1,7,6,2,4,6,4,5,4,2,3,-1,-1,-1},
    {1,0,3,1,3,6,0,4,3,2,3,5,4,5,3},
    {1,6,0,1,5,6,1,7,5,4,5,7,2,3,8},
    {5,1,0,5,0,3,4,2,0,2,3,0,-1,-1,-1},
    {4,5,2,4,2,3,5,0,2,6,2,1,0,1,2},
    {0,4,1,5,2,3,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {3,4,0,3,0,2,1,5,0,5,2,0,-1,-1,-1},
    {1,2,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {1,0,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {1,0,4,5,3,2,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {0,1,4,5,3,2,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {4,0,5,4,1,0,6,3,2,-1,-1,-1,-1,-1,-1},
    {4,0,1,2,5,3,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {1,2,7,3,0,6,4,8,5,-1,-1,-1,-1,-1,-1},
    {1,4,0,1,5,4,2,6,3,-1,-1,-1,-1,-1,-1},
    {2,7,3,0,6,1,6,4,1,6,5,4,-1,-1,-1},
    {3,0,1,2,0,3,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {3,0,4,3,2,0,2,1,0,-1,-1,-1,-1,-1,-1},
    {2,5,4,2,3,5,0,1,6,-1,-1,-1,-1,-1,-1},
    {0,2,1,0,4,2,0,5,4,4,3,2,-1,-1,-1},
    {4,3,2,4,0,3,0,1,3,-1,-1,-1,-1,-1,-1},
    {5,3,2,1,3,5,1,4,3,1,0,4,-1,-1,-1},
    {0,1,3,0,3,5,0,5,4,2,5,3,-1,-1,-1},
    {1,0,4,1,4,2,2,4,3,-1,-1,-1,-1,-1,-1},
    {1,2,0,3,2,1,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {1,3,4,1,0,3,0,2,3,-1,-1,-1,-1,-1,-1},
    {4,3,6,4,2,3,5,0,1,-1,-1,-1,-1,-1,-1},
    {4,2,3,4,3,1,4,1,0,5,1,3,-1,-1,-1},
    {3,4,2,3,6,4,1,5,0,-1,-1,-1,-1,-1,-1},
    {1,2,6,3,0,7,0,5,7,0,4,5,-1,-1,-1},
    {2,7,4,2,3,7,0,1,5,1,6,5,-1,-1,-1},
    {5,4,1,5,1,0,4,2,1,6,1,3,2,3,1},
    {4,0,1,4,2,0,2,3,0,-1,-1,-1,-1,-1,-1},
    {0,2,1,2,3,1,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {1,7,0,2,3,4,2,4,5,4,3,6,-1,-1,-1},
    {0,4,2,0,2,1,1,2,3,-1,-1,-1,-1,-1,-1},
    {4,0,1,4,3,0,4,2,3,3,5,0,-1,-1,-1},
    {4,1,0,4,0,3,3,0,2,-1,-1,-1,-1,-1,-1},
    {2,3,1,2,1,4,3,6,1,0,1,5,6,5,1},
    {3,2,0,1,3,0,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {0,4,1,3,2,5,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {0,6,1,2,7,3,8,5,4,-1,-1,-1,-1,-1,-1},
    {3,0,1,3,2,0,5,4,6,-1,-1,-1,-1,-1,-1},
    {7,5,4,6,1,2,1,3,2,1,0,3,-1,-1,-1},
    {6,3,2,7,0,1,5,4,8,-1,-1,-1,-1,-1,-1},
    {6,11,7,1,2,10,0,8,3,4,9,5,-1,-1,-1},
    {5,4,7,3,2,6,2,1,6,2,0,1,-1,-1,-1},
    {1,2,6,1,3,2,1,0,3,7,3,0,8,5,4},
    {5,0,1,5,4,0,3,2,6,-1,-1,-1,-1,-1,-1},
    {7,3,2,0,6,4,0,4,1,4,6,5,-1,-1,-1},
    {3,6,2,3,7,6,1,5,0,5,4,0,-1,-1,-1},
    {4,1,6,4,6,5,1,0,6,2,6,3,0,3,6},
    {6,3,2,7,0,4,0,5,4,0,1,5,-1,-1,-1},
    {1,4,8,1,5,4,1,0,5,6,5,0,7,3,2},
    {2,0,6,2,6,3,0,1,6,4,6,5,1,5,6},
    {3,2,5,3,5,4,1,0,5,0,4,5,-1,-1,-1},
    {1,3,0,1,4,3,4,2,3,-1,-1,-1,-1,-1,-1},
    {1,3,5,0,3,1,0,2,3,0,4,2,-1,-1,-1},
    {0,5,4,0,2,5,0,1,2,2,3,5,-1,-1,-1},
    {3,4,1,3,1,2,2,1,0,-1,-1,-1,-1,-1,-1},
    {0,1,6,5,2,7,5,7,4,7,2,3,-1,-1,-1},
    {0,8,3,0,5,8,0,6,5,4,5,6,1,2,7},
    {6,4,2,6,2,3,4,0,2,5,2,1,0,1,2},
    {3,5,1,3,1,2,0,4,1,4,2,1,-1,-1,-1},
    {2,4,5,2,0,4,2,3,0,1,4,0,-1,-1,-1},
    {4,2,3,4,3,0,0,3,1,-1,-1,-1,-1,-1,-1},
    {1,4,6,1,6,0,4,5,6,3,6,2,5,2,6},
    {0,2,3,1,0,3,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {0,1,3,0,3,6,1,4,3,2,3,5,4,5,3},
    {5,1,0,5,0,3,4,2,0,2,3,0,-1,-1,-1},
    {0,1,4,2,3,5,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {2,0,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {3,0,2,1,0,3,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {6,2,5,6,3,2,4,1,0,-1,-1,-1,-1,-1,-1},
    {2,6,3,2,5,6,1,4,0,-1,-1,-1,-1,-1,-1},
    {6,3,2,6,7,3,5,4,0,4,1,0,-1,-1,-1},
    {4,0,1,4,3,0,3,2,0,-1,-1,-1,-1,-1,-1},
    {0,6,3,1,2,5,1,5,4,5,2,7,-1,-1,-1},
    {4,3,2,4,1,3,4,0,1,1,5,3,-1,-1,-1},
    {3,2,0,3,0,6,2,5,0,1,0,4,5,4,0},
    {0,2,4,0,1,2,1,3,2,-1,-1,-1,-1,-1,-1},
    {4,1,0,4,2,1,4,3,2,5,1,2,-1,-1,-1},
    {6,0,1,4,7,3,4,3,5,3,7,2,-1,-1,-1},
    {5,4,1,5,1,0,4,3,1,6,1,2,3,2,1},
    {0,1,2,1,3,2,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {0,4,3,0,3,1,1,3,2,-1,-1,-1,-1,-1,-1},
    {4,0,1,4,1,2,2,1,3,-1,-1,-1,-1,-1,-1},
    {3,2,1,0,3,1,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {1,2,0,1,3,2,3,4,2,-1,-1,-1,-1,-1,-1},
    {3,0,2,3,5,0,3,4,5,5,1,0,-1,-1,-1},
    {0,1,5,4,2,6,4,6,7,6,2,3,-1,-1,-1},
    {5,6,2,5,2,3,6,1,2,4,2,0,1,0,2},
    {1,3,0,1,4,3,1,5,4,2,3,4,-1,-1,-1},
    {0,4,6,0,6,3,4,5,6,2,6,1,5,1,6},
    {0,1,3,0,3,5,1,6,3,2,3,4,6,4,3},
    {4,2,3,0,5,1,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {0,3,5,1,3,0,1,2,3,1,4,2,-1,-1,-1},
    {3,4,1,3,1,2,2,1,0,-1,-1,-1,-1,-1,-1},
    {3,8,2,3,5,8,3,6,5,4,5,6,0,1,7},
    {3,5,1,3,1,2,0,4,1,4,2,1,-1,-1,-1},
    {4,2,3,4,3,1,1,3,0,-1,-1,-1,-1,-1,-1},
    {0,2,3,1,0,3,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {4,2,3,4,3,1,5,0,3,0,1,3,-1,-1,-1},
    {2,0,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {0,4,1,0,2,4,2,3,4,-1,-1,-1,-1,-1,-1},
    {0,4,1,2,5,3,5,7,3,5,6,7,-1,-1,-1},
    {1,4,5,1,5,2,1,2,0,3,2,5,-1,-1,-1},
    {1,0,2,1,2,4,0,5,2,3,2,6,5,6,2},
    {2,5,3,4,5,2,4,1,5,4,0,1,-1,-1,-1},
    {7,5,4,7,8,5,7,1,8,2,8,1,0,6,3},
    {4,3,2,4,2,1,1,2,0,-1,-1,-1,-1,-1,-1},
    {5,3,2,5,2,0,4,1,2,1,0,2,-1,-1,-1},
    {0,4,5,0,3,4,0,1,3,3,2,4,-1,-1,-1},
    {5,6,3,5,3,2,6,1,3,4,3,0,1,0,3},
    {3,5,6,3,6,2,5,4,6,1,6,0,4,0,6},
    {0,5,1,4,3,2,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {2,4,0,2,0,3,3,0,1,-1,-1,-1,-1,-1,-1},
    {2,5,1,2,1,3,0,4,1,4,3,1,-1,-1,-1},
    {2,0,1,3,2,1,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {0,2,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {1,2,0,2,3,0,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {1,0,2,1,2,4,4,2,3,-1,-1,-1,-1,-1,-1},
    {0,1,3,0,3,2,2,3,4,-1,-1,-1,-1,-1,-1},
    {1,0,2,3,1,2,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {0,1,4,0,4,3,3,4,2,-1,-1,-1,-1,-1,-1},
    {3,0,4,3,4,5,1,2,4,2,5,4,-1,-1,-1},
    {0,1,3,2,0,3,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {1,0,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {0,1,2,0,2,4,4,2,3,-1,-1,-1,-1,-1,-1},
    {2,3,1,0,2,1,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {2,3,4,2,4,5,0,1,4,1,5,4,-1,-1,-1},
    {0,2,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {0,1,2,3,0,2,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {0,2,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {0,1,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1},
    {-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1}
};

float* data;
float* points;
int dataLength;
int sizeX;
int sizeY;
int sizeZ;
float* verts;
int vertsNum;
int* indices;
int indicesNum;


// data length is the number of dataPoints
float* EMSCRIPTEN_KEEPALIVE assignDataLocation(int x, int y, int z) {
    dataLength = x*y*z;
    sizeX = x;
    sizeY = y;
    sizeZ = z;
    data = malloc(dataLength * sizeof(float));
    return data;
}

float* EMSCRIPTEN_KEEPALIVE assignPointsLocation(int x, int y, int z) {
    pointsLength = x*y*z*3;
    sizeX = x;
    sizeY = y;
    sizeZ = z;
    points = malloc(pointsLength * sizeof(float));
    return points;
}

// load data into wasm module

// enumeration to see how many verts/indicies are generated
int getVertsCount() {
    int total = 0;
    for (int i = 0; i < codesCount; i++) {
        // loop through each code
        for (int j = 0; j < 12; j++) {
            if (edgeTable[codes[i]][j] != -1) {
                total++;
            } else {
                break;
            }
        }
    }    
    return total;
}

int getIndicesCount() {
    int total = 0;
    for (int i = 0; i < codesCount; i++) {
        // loop through each code
        for (int j = 0; j < 15; j++) {
            if (triTable[codes[i]][j] != -1) {
                total++;
            } else {
                break;
            }
        }
    }    
    return total;
}

// get the positions of the verts for a cell
void addVerts(
    float* verts, 
    float* normals, 
    int* curr, 
    int code, 
    int x, 
    int y, 
    int z, 
    float* data, 
    float* points,
    int X, 
    int Y, 
    int Z, 
    float threshold, 
    bool pointsBool
) {
    int* edges = edgeTable[code];
    for (int i = 0; i < 12; i++) {
        if (edges[i] != -1) {
            // add vertex position to vertex list
            int connected[2] = {
                edgeToVertsTable[edges[i]][0],
                edgeToVertsTable[edges[i]][1],
            };

            int a[3] = {
                vertCoordTable[connected[0]][0],
                vertCoordTable[connected[0]][1],
                vertCoordTable[connected[0]][2]
            };
            int b[3] = {
                vertCoordTable[connected[1]][0],
                vertCoordTable[connected[1]][1],
                vertCoordTable[connected[1]][2]
            };

            int aInd = Y*Z*(a[0] + x) + Z*(a[1] + y) + a[2] + z;
            int bInd = Y*Z*(b[0] + x) + Z*(b[1] + y) + b[2] + z
            // the values at the endpoints of the edge
            float va = data[aInd];
            float vb = data[bInd];
            
            float fac = (threshold-va)/(vb-va);

            if (points == true) {
                // if the points are defined explicitly
                float pa[3] = {
                    points[3*aInd + 0],
                    points[3*aInd + 1],
                    points[3*aInd + 2]
                };
                float pb[3] = {
                    points[3*bInd + 0],
                    points[3*bInd + 1],
                    points[3*bInd + 2]
                };
                verts[3*(*curr) + 0] = pa[0]*(1-fac) + pb[0]*fac;
                verts[3*(*curr) + 1] = pa[1]*(1-fac) + pb[1]*fac;
                verts[3*(*curr) + 2] = pa[2]*(1-fac) + pb[2]*fac;
            } else {
                verts[3*(*curr) + 0] = (float)a[0]*(1-fac) + (float)b[0]*fac + (float)x;
                verts[3*(*curr) + 1] = (float)a[1]*(1-fac) + (float)b[1]*fac + (float)y;
                verts[3*(*curr) + 2] = (float)a[2]*(1-fac) + (float)b[2]*fac + (float)z;
            }
            (*curr)++;
        } else {
            break;
        }
    }
}

// extract isosurface 
int EMSCRIPTEN_KEEPALIVE generateMesh(float threshold, bool pointsBool) {
    vertsNum = getVertsCount();
    verts = (float*) malloc(vertsNum * 3 * sizeof(float));
    
    indicesNum = getIndicesCount();
    indices = (int*) malloc(indicesNum * sizeof(int));

    normals = (float*) malloc(vertsNum * 3 * sizeof(float));
    
    int X = sizeX-1;
    int Y = sizeY-1;
    int Z = sizeZ-1;
    // holds current vertex number in array
    int currVert = 0;
    int currInd = 0;
    int codeIndex = 0;

    for (int i = 0; i < X; i++) {
        for (int j = 0; j < Y; j++) {
            for (int k = 0; k < Z; k++) {
                // calculate code for this cell
                int code = 0;
                for (int l = 0; l < 8; l++) {
                    int* c = vertCoordTable[l];
                    // indexing data needs full dimensions
                    index = sizeY * sizeZ * (i + c[0]) + sizeZ * (j + c[1]) + k + c[2];
                    float val = data[index];
                    // indexing codes uses X Y Z (dim - 1)
                    code |= (val > threshold) << l;
                }
                if (code == 0 || code == 255) {
                    continue;
                }
                addIndices(indices, &currInd, currVert, code);
                addVerts(verts, normals, &currVert, codes[codeIndex], i, j, k, data, points, sizeX, sizeY, sizeZ, threshold, pointsBool);
                // calculate indices values
            }
        }
    }
    return vertsNum;
}


// free the memory used for this isosurface
void EMSCRIPTEN_KEEPALIVE freeMem () {
    free(verts);
    free(indices);
}